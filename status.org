these are the parameters in my tm force field not covered at all by the sage+tm
torsion drive data set, when checking by actual driven torsions. the third
column is generated by the awk snippet below. ~Init~ is the initial coverage and
~ChEMBL~ is the number of matching SMILES found in the ChEMBL 33 database. ~Found~
is the number of new molecules identified for inclusion in the new dataset by
the fingerprint program

#+name: uncovered
| Param | Init | ChEMBL | Found |
|-------+------+--------+-------|
| t133g |    0 |      4 |     1 |
| t18b  |    0 |      8 |     2 |
| t87a  |    0 |     14 |     6 |
| t130h |    0 |     18 |     3 |
| t120h |    0 |     19 |     5 |
| t119h |    0 |     28 |     6 |
| t62g  |    0 |     32 |     6 |
| t133h |    0 |     33 |     5 |
| t61g  |    0 |     33 |     9 |
| t132h |    0 |     58 |     5 |
| t138a |    0 |     96 |     6 |
| t118h |    0 |    128 |     6 |
| t142j |    0 |    155 |    12 |
| t116i |    0 |    158 |     5 |
| t89   |    0 |    435 |     5 |
| t142k |    0 |    503 |    15 |
| t101  |    0 |    955 |    11 |
| t141  |    0 |   1974 |    11 |
| t88   |    0 |   3818 |     5 |
| t18a  |    0 |   4245 |     4 |
| t116j |    0 |   6306 |    17 |
| t72h  |    0 |   6969 |    12 |
| t115h |    0 |   7736 |    22 |
| t165  |    0 |  34267 |    11 |
| t141b |    0 |  53491 |    36 |
| t83h  |    0 |  89906 |     7 |
| t141c |    0 | 139173 |   203 |

#+name: not-covered-by-chembl
| Param | Init | ChEMBL |
|-------+------+--------|
| t123  |    0 |      0 |
| t130g |    0 |      0 |
| t132g |    0 |      0 |
| t132i |    0 |      0 |
| t142l |    0 |      0 |
| t143i |    0 |      0 |
| t166  |    0 |      0 |
| t167  |    0 |      0 |
| t59g  |    0 |      0 |
| t60g  |    0 |      0 |

#+begin_src awk :stdin uncovered :results raw drawer
  BEGIN {
	  dbscan = "dbscan = {epsilon = 0.5, min_pts = 1}"
	  fragment = "fragment = true"
  }
  NR > 1 {
	  printf "{id = \"%s\", smiles = \"output/%s.smiles\", %s, %s},\n", $1, $1,
		  dbscan, fragment
  }
#+end_src

#+RESULTS:
:results:
{id = "t133g", smiles = "output/t133g.smiles", dbscan = {epsilon = 0.5, min_pts = 1}, fragment = true},
{id = "t18b", smiles = "output/t18b.smiles", dbscan = {epsilon = 0.5, min_pts = 1}, fragment = true},
{id = "t87a", smiles = "output/t87a.smiles", dbscan = {epsilon = 0.5, min_pts = 1}, fragment = true},
{id = "t130h", smiles = "output/t130h.smiles", dbscan = {epsilon = 0.5, min_pts = 1}, fragment = true},
{id = "t120h", smiles = "output/t120h.smiles", dbscan = {epsilon = 0.5, min_pts = 1}, fragment = true},
{id = "t119h", smiles = "output/t119h.smiles", dbscan = {epsilon = 0.5, min_pts = 1}, fragment = true},
{id = "t62g", smiles = "output/t62g.smiles", dbscan = {epsilon = 0.5, min_pts = 1}, fragment = true},
{id = "t133h", smiles = "output/t133h.smiles", dbscan = {epsilon = 0.5, min_pts = 1}, fragment = true},
{id = "t61g", smiles = "output/t61g.smiles", dbscan = {epsilon = 0.5, min_pts = 1}, fragment = true},
{id = "t132h", smiles = "output/t132h.smiles", dbscan = {epsilon = 0.5, min_pts = 1}, fragment = true},
{id = "t138a", smiles = "output/t138a.smiles", dbscan = {epsilon = 0.5, min_pts = 1}, fragment = true},
{id = "t118h", smiles = "output/t118h.smiles", dbscan = {epsilon = 0.5, min_pts = 1}, fragment = true},
{id = "t142j", smiles = "output/t142j.smiles", dbscan = {epsilon = 0.5, min_pts = 1}, fragment = true},
{id = "t116i", smiles = "output/t116i.smiles", dbscan = {epsilon = 0.5, min_pts = 1}, fragment = true},
{id = "t89", smiles = "output/t89.smiles", dbscan = {epsilon = 0.5, min_pts = 1}, fragment = true},
{id = "t142k", smiles = "output/t142k.smiles", dbscan = {epsilon = 0.5, min_pts = 1}, fragment = true},
{id = "t101", smiles = "output/t101.smiles", dbscan = {epsilon = 0.5, min_pts = 1}, fragment = true},
{id = "t141", smiles = "output/t141.smiles", dbscan = {epsilon = 0.5, min_pts = 1}, fragment = true},
{id = "t88", smiles = "output/t88.smiles", dbscan = {epsilon = 0.5, min_pts = 1}, fragment = true},
{id = "t18a", smiles = "output/t18a.smiles", dbscan = {epsilon = 0.5, min_pts = 1}, fragment = true},
{id = "t116j", smiles = "output/t116j.smiles", dbscan = {epsilon = 0.5, min_pts = 1}, fragment = true},
{id = "t72h", smiles = "output/t72h.smiles", dbscan = {epsilon = 0.5, min_pts = 1}, fragment = true},
{id = "t115h", smiles = "output/t115h.smiles", dbscan = {epsilon = 0.5, min_pts = 1}, fragment = true},
{id = "t165", smiles = "output/t165.smiles", dbscan = {epsilon = 0.5, min_pts = 1}, fragment = true},
{id = "t141b", smiles = "output/t141b.smiles", dbscan = {epsilon = 0.5, min_pts = 1}, fragment = true},
{id = "t83h", smiles = "output/t83h.smiles", dbscan = {epsilon = 0.5, min_pts = 1}, fragment = true},
{id = "t141c", smiles = "output/t141c.smiles", dbscan = {epsilon = 0.5, min_pts = 1}, fragment = true},
:end:

#+begin_src awk :stdin uncovered
  NR > 1 {
	  cmd = "wc -l output/" $1 ".smiles 2> /dev/null"
	  if ((cmd | getline tmp) != 0) {
		  split(tmp, arr)
		  $3 = arr[1]
	  } else $3 = 0
	  print | "sort -nk3"
	  close(cmd)
  }
#+end_src

#+RESULTS:
| t123  | 0 |      0 |
| t130g | 0 |      0 |
| t132g | 0 |      0 |
| t132i | 0 |      0 |
| t142l | 0 |      0 |
| t143i | 0 |      0 |
| t166  | 0 |      0 |
| t167  | 0 |      0 |
| t59g  | 0 |      0 |
| t60g  | 0 |      0 |
| t133g | 0 |      4 |
| t18b  | 0 |      8 |
| t87a  | 0 |     14 |
| t130h | 0 |     18 |
| t120h | 0 |     19 |
| t119h | 0 |     28 |
| t62g  | 0 |     32 |
| t133h | 0 |     33 |
| t61g  | 0 |     33 |
| t132h | 0 |     58 |
| t130i | 0 |     67 |
| t138a | 0 |     96 |
| t118h | 0 |    128 |
| t142j | 0 |    155 |
| t116i | 0 |    158 |
| t89   | 0 |    435 |
| t142k | 0 |    503 |
| t101  | 0 |    955 |
| t141  | 0 |   1974 |
| t88   | 0 |   3818 |
| t18a  | 0 |   4245 |
| t116j | 0 |   6306 |
| t72h  | 0 |   6969 |
| t115h | 0 |   7736 |
| t165  | 0 |  34267 |
| t141b | 0 |  53491 |
| t83h  | 0 |  89906 |
| t141c | 0 | 139173 |

Initial and Found are in units of molecules, and initial corresponds to my
coverage check on v2-tm on its training data. Molecules is the number of SMILES
in the corresponding output file from the initial search

I was using looser epsilon for the parameters with fewer initial molecule
matches, but 120h, in particular, had several very similar molecules. 0.7 seems
like a good cutoff for filtering out this kind of thing

#+name: results
| Parameter | Molecules | Initial | Found |
|-----------+-----------+---------+-------|
| t143j     |         2 |       6 |     2 |
| t122g     |         3 |       5 |     2 |
| t133g     |         4 |       0 |     2 |
| t18b      |         8 |       0 |     2 |
| t87a      |        14 |       0 |     4 |
| t130h     |        18 |       0 |     8 |
| t120h     |        19 |       2 |     5 |
| t122l     |        19 |       2 |    10 |
| t42a      |        22 |      13 |     9 |
| t102      |        24 |       6 |    12 |
| t119h     |        28 |       3 |     6 |
| t62g      |        32 |       0 |     8 |
| t61g      |        33 |       0 |     9 |
| t133h     |        33 |       0 |     5 |
| t133i     |        42 |       5 |     7 |
| t122j     |        57 |       7 |     5 |
| t132h     |        58 |       8 |    11 |
| t130i     |        67 |       1 |    14 |
| t138a     |        96 |       0 |    12 |
| t103      |       100 |       8 |    12 |
| t118h     |       128 |       7 |    11 |
| t143k     |       132 |       5 |    14 |
| t112      |       147 |       4 |    15 |
| t142j     |       155 |       0 |    15 |
| t116i     |       158 |       0 |    16 |
| t164      |       189 |       5 |    13 |
| t8        |       199 |       6 |    12 |
| t113      |       226 |       8 |     9 |
| t7        |       250 |       8 |    14 |
| t155      |       280 |       9 |    10 |
| t126      |       281 |       3 |    14 |
| t73h      |       302 |      11 |    17 |
| t89       |       435 |       1 |    17 |
| t74h      |       463 |      10 |    14 |
| t142k     |       503 |       0 |    16 |
| t54       |       700 |      10 |     9 |
| t63       |       718 |      10 |    15 |
| t55       |       942 |      12 |     6 |
| t101      |       955 |       3 |    18 |
| t133j     |      1052 |      10 |    11 |
| t91       |      1168 |      10 |    10 |
| t100      |      1613 |       6 |    10 |
| t48a      |      1861 |       1 |    15 |
| t141      |      1974 |       6 |    10 |
| t65       |      2490 |      11 |     7 |
| t30       |      2563 |       6 |    11 |
| t153      |      2701 |      13 |     8 |
| t142h     |      2749 |       9 |     7 |
| t6        |      2809 |      14 |     4 |
| t12       |      3035 |      14 |     2 |
| t52       |      3339 |       9 |    14 |
| t56       |      3394 |       8 |    10 |
| t53       |      3525 |       9 |    12 |
| t19a      |      3535 |       4 |    13 |
| t88       |      3818 |       7 |     8 |
| t57       |      3960 |       5 |    14 |
| t18a      |      4245 |       3 |    15 |
| t37       |      4484 |      14 |    16 |
| t128      |      4494 |       8 |     8 |
| t125      |      4963 |       9 |    11 |
| t124      |      5129 |       7 |    10 |
| t136      |      6210 |      14 |    13 |
| t116j     |      6306 |       0 |    15 |
| t72h      |      6969 |       4 |    12 |
| t115h     |      7736 |       0 |    15 |
| t71h      |      9470 |      10 |    10 |
| t158      |     10273 |       5 |    11 |
| t122i     |     11357 |       5 |    10 |
| t82a      |     12265 |      11 |     8 |
| t134      |     13017 |      11 |     9 |
| t49       |     17544 |       9 |     8 |
| t123a     |     17562 |      10 |     5 |
| t82h      |     17847 |      10 |     6 |
| t135      |     18139 |       8 |    16 |
| t165      |     34267 |      13 |    13 |
| t99       |     36126 |      14 |    16 |
| t68       |     38862 |       9 |    12 |
| t141b     |     53491 |       1 |    17 |
| t150      |     62029 |       9 |     7 |
| t81       |     81527 |       1 |    15 |
| t83h      |     89906 |      12 |    13 |
| t141c     |    139173 |       9 |    26 |
| t141a     |    179719 |      10 |    13 |

# Local Variables:
# org-confirm-babel-evaluate: nil
# End:
